<!-- 0886dcff-f465-4281-ba7d-be068015a5ad 01572990-5101-4953-8686-afebe849939f -->
# 个人界面设置扩展

## 概述

在ProfileFragment中新增三大设置模块，每个模块包含若干功能项，未登录用户点击时跳转到登录页。

## 一、UI布局扩展

### 1. 创建带开关的菜单项布局

创建 `view_profile_menu_item_switch.xml`，基于现有的 `view_profile_menu_item.xml`，增加Switch开关控件

### 2. 更新 fragment_profile.xml

在现有的快捷操作卡片下方，新增三个MaterialCardView分组：

**账户与安全分组**

- 个人资料（图标：ic_ancient_desk）
- 账号安全（图标：ic_heritage_artifacts）
- 绑定手机号（图标：ic_temple）

**消息与提醒分组**

- 推送通知（图标：ic_sky_lantern，带开关）
- 活动与优惠（图标：ic_bamboo，带开关）
- 位置服务（图标：ic_heritage_entrance，带开关）

**辅助功能分组**

- 发票与报销（图标：ic_ancient_book）
- 帮助与反馈（图标：ic_culture）

### 3. 新增字符串资源

在 `strings.xml` 添加：

- 账户与安全、消息与提醒、辅助功能分组标题
- 各菜单项标题和说明文字

## 二、创建新的Activity

### 1. PersonalInfoActivity（个人资料编辑）

**文件位置**：`app/src/main/java/com/just/cn/mgg/ui/profile/PersonalInfoActivity.java`

**布局**：`activity_personal_info.xml`

- Toolbar返回按钮
- 用户头像（可点击修改）
- 昵称输入框
- 性别选择
- 生日选择
- 保存按钮

**功能**：

- 显示当前用户信息
- 支持编辑昵称、性别、生日
- 头像选择（相册/相机）
- 保存到SharedPreferences

### 2. AccountSecurityActivity（账号安全）

**文件位置**：`app/src/main/java/com/just/cn/mgg/ui/profile/AccountSecurityActivity.java`

**布局**：`activity_account_security.xml`

- Toolbar
- 修改密码选项
- 二次验证设置选项
- 登录记录选项

**功能**：

- 点击项显示Toast "功能开发中"（为后续扩展预留）

### 3. PhoneBindingActivity（绑定手机号）

**文件位置**：`app/src/main/java/com/just/cn/mgg/ui/profile/PhoneBindingActivity.java`

**布局**：`activity_phone_binding.xml`

- Toolbar
- 当前手机号显示
- 更换手机号按钮
- 验证码输入（预留）

**功能**：

- 显示已绑定手机号
- 点击更换显示Toast "功能开发中"

### 4. InvoiceActivity（发票与报销）

**文件位置**：`app/src/main/java/com/just/cn/mgg/ui/profile/InvoiceActivity.java`

**布局**：`activity_invoice.xml`

- Toolbar
- 发票抬头管理
- 历史发票记录（空状态）

**功能**：

- 空状态提示页面
- 添加发票抬头按钮（Toast提示）

### 5. FeedbackActivity（帮助与反馈）

**文件位置**：`app/src/main/java/com/just/cn/mgg/ui/profile/FeedbackActivity.java`

**布局**：`activity_feedback.xml`

- Toolbar
- 常见问题列表
- 反馈建议输入框
- 联系方式输入
- 提交按钮

**功能**：

- 显示FAQ列表（可折叠）
- 反馈表单提交（Toast提示已提交）

## 三、开关状态管理

### 1. 扩展 SPUtils.java

添加设置项相关方法：

```java
// 推送通知开关
public static final String KEY_PUSH_NOTIFICATION = "push_notification";
// 活动与优惠开关
public static final String KEY_ACTIVITY_PROMOTION = "activity_promotion";
// 位置服务开关
public static final String KEY_LOCATION_SERVICE = "location_service";

// 用户信息
public static final String KEY_USER_AVATAR = "user_avatar";
public static final String KEY_USER_GENDER = "user_gender";
public static final String KEY_USER_BIRTHDAY = "user_birthday";
```

添加便捷方法获取和保存开关状态，默认值：推送通知=true，活动与优惠=true，位置服务=false

### 2. 更新 Constants.java

添加新的常量定义

## 四、更新 ProfileFragment.java

### 1. 添加成员变量

```java
private LinearLayout llPersonalInfo, llAccountSecurity, llPhoneBinding;
private LinearLayout llInvoice, llFeedback;
private SwitchCompat swPushNotification, swActivityPromotion, swLocationService;
```

### 2. 实现点击事件

- 所有菜单项点击前检查登录状态
- 未登录跳转LoginActivity
- 已登录跳转对应Activity

### 3. 实现开关监听

- 开关变化时保存到SharedPreferences
- onResume时读取并设置开关状态

## 五、图标资源

复用现有图标：

- ic_ancient_desk（个人资料）
- ic_heritage_artifacts（账号安全）
- ic_temple（绑定手机号）
- ic_sky_lantern（推送通知）
- ic_bamboo（活动与优惠）
- ic_heritage_entrance（位置服务）
- ic_ancient_book（发票与报销）
- ic_culture（帮助与反馈）

## 六、实施步骤

1. 创建view_profile_menu_item_switch.xml布局
2. 更新strings.xml添加所有字符串资源
3. 更新fragment_profile.xml添加三大设置分组
4. 扩展SPUtils.java和Constants.java
5. 创建5个新Activity及其布局文件
6. 更新ProfileFragment.java实现所有点击事件和开关逻辑
7. 在AndroidManifest.xml注册新Activity

### To-dos

- [ ] 创建view_profile_menu_item_switch.xml布局文件
- [ ] 更新strings.xml添加所有新的字符串资源
- [ ] 更新fragment_profile.xml添加三大设置分组
- [ ] 扩展SPUtils.java添加设置项保存和读取方法
- [ ] 创建PersonalInfoActivity及其布局文件
- [ ] 创建AccountSecurityActivity及其布局文件
- [ ] 创建PhoneBindingActivity及其布局文件
- [ ] 创建InvoiceActivity及其布局文件
- [ ] 创建FeedbackActivity及其布局文件
- [ ] 更新ProfileFragment.java实现点击事件和开关逻辑
- [ ] 在AndroidManifest.xml注册所有新Activity